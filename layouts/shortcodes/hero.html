{{ with .Get "src" }}
{{ $src := $.Page.Resources.GetMatch (printf "*%s*" ($.Get "src")) }}
{{ $thumb := $src.Process "resize 400x webp q70" }}
<figure class="hero">
  {{ if ge $src.Width 800 }}<a href="{{ $src.RelPermalink }}">{{ end }}
    <img src="{{ $thumb.RelPermalink }}" width="{{ $thumb.Width }}" height="{{ $thumb.Height }}" />
  {{ if ge $src.Width 800 }}</a>{{ end }}
  {{ if $.Get "caption" }}<figcaption>{{ $.Get "caption" }}</figcaption>{{ end }}
</figure>
{{ end }}
